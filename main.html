<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile / Contact</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000000;
        }
        .mobile-container {
            width: 100%;
            padding: 1.5rem;
            max-width: 30rem; 
            margin: 0 auto;
            /* ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙ„Ø§Ø³ Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ø§ÙØ© Ø¨Ø§Ø¯Ø¦Ø© Ø¹Ù„ÙˆÙŠØ© Ø£ÙƒØ¨Ø± */
            padding-top: 4rem; /* Ù…Ø³Ø§ÙØ© Ø¨Ø§Ø¯Ø¦Ø© Ø¹Ù„ÙˆÙŠØ© Ù„ØªØ¬Ù†Ø¨ ØªØ¯Ø§Ø®Ù„ Ø£Ø²Ø±Ø§Ø± ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø§Ù„Ø¹Ù„ÙˆÙŠØ© */
        }
        body, html {
            height: 100%; 
        }
        .profile-picture {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 9999px;
        }
        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© */
        .modal-overlay {
            z-index: 1000; 
            background-color: rgba(0, 0, 0, 0.7);
        }
    </style>
</head>
<body class="bg-black text-white antialiased">
    
    <audio id="bipSound" src="bip.mp3" preload="metadata"></audio>
    <audio id="backSound" src="back.mp3" preload="metadata"></audio>

    <div class="mobile-container flex flex-col items-center">
        
        <header class="w-full mb-10 flex justify-between items-center"> 
            <button id="backButton" class="text-neutral-400 hover:text-white transition duration-150 flex items-center p-1 -ml-1">
                <svg class="w-6 h-6 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                <span class="font-medium">Back</span>
            </button>
            
            <p id="uniqueIDDisplay" class="text-sm font-semibold text-neutral-500 text-right p-1">ID: LOADING...</p>
        </header>
        
        <div class="flex flex-col items-center w-full mb-10">
            
            <div class="relative w-28 h-28 mb-4">
                
                <div class="w-full h-full rounded-full bg-neutral-800 border-4 border-neutral-700 overflow-hidden">
                    <img id="profileImage" class="profile-picture" src="https://via.placeholder.com/150/333333/FFFFFF?text=ğŸ‘¤" alt="Profile Picture">
                </div>
                

                <input type="file" id="imageUpload" accept="image/*" class="hidden">
                
                <button id="changeImageButton" 
                        class="absolute bottom-0 left-1/2 transform -translate-x-1/2 w-full pt-6 pb-1 
                               bg-black bg-opacity-60 text-white text-xs font-semibold rounded-b-full 
                               hover:bg-opacity-70 transition duration-300">
                    
                    <span class="flex items-center justify-center">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                        Edit Photo
                    </span>
                </button>
            </div>
            
            <h1 class="text-3xl font-bold text-white mb-2" id="profileName">My Profile</h1>
            <p class="text-neutral-400">Manage your details and support</p>
        </div>

        <div class="w-full space-y-4">
            
            <div class="bg-neutral-900 p-4 rounded-xl border border-neutral-800 shadow-lg">
                <h3 class="text-lg font-semibold text-white">Account Information</h3>
                <p class="text-sm text-neutral-400 mt-1">Username: <span id="displayUsername" class="text-white font-medium">Loading...</span></p>
                <button id="editUsernameButton" class="mt-3 w-full bg-neutral-700 text-white font-semibold py-2 rounded-lg hover:bg-neutral-600 transition duration-150 text-sm">
                    Edit Username
                </button>
            </div>
            
            <div class="bg-neutral-900 p-4 rounded-xl border border-neutral-800 shadow-lg">
                <h3 class="text-lg font-semibold text-white">Funds & Payments</h3>
                <p class="text-sm text-neutral-400 mt-1">Need to report a problem with your funds?</p>
                <button id="reportFundsButton" class="mt-3 w-full bg-red-700 text-white font-semibold py-3 rounded-lg hover:bg-red-600 transition duration-150">
                    Report funds problems
                </button>
            </div>
            
            <button id="logoutButton"
                    class="w-full bg-neutral-800 text-red-400 font-semibold py-4 rounded-xl hover:bg-neutral-700 transition duration-150 mt-8">
                Log Out
            </button>

        </div>
    </div>
    
    <div id="logoutModal" class="modal-overlay fixed inset-0 flex items-center justify-center hidden">
        <div class="bg-neutral-900 p-6 rounded-xl w-11/12 max-w-sm border border-neutral-700 shadow-2xl">
            <h3 class="text-xl font-bold text-white mb-4">Confirm Log Out</h3>
            <p class="text-neutral-300 mb-6">Are you sure you want to log out of your account?</p>
            <div class="flex justify-end space-x-3">
                <button id="confirmLogoutNo" class="bg-neutral-700 text-white font-semibold px-4 py-2 rounded-lg hover:bg-neutral-600 transition duration-150">
                    No
                </button>
                <button id="confirmLogoutYes" class="bg-red-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-red-500 transition duration-150">
                    Yes
                </button>
            </div>
        </div>
    </div>

    <div id="fundsModal" class="modal-overlay fixed inset-0 flex items-center justify-center hidden">
        <div class="bg-neutral-900 p-6 rounded-xl w-11/12 max-w-sm border border-neutral-700 shadow-2xl">
            <h3 class="text-xl font-bold text-yellow-400 mb-4">Payment Status</h3>
            <p class="text-neutral-300 mb-6">You don't have any pending payment transaction.</p>
            <div class="flex justify-end">
                <button id="closeFundsModal" class="bg-neutral-700 text-white font-semibold px-4 py-2 rounded-lg hover:bg-neutral-600 transition duration-150">
                    OK
                </button>
            </div>
        </div>
    </div>
    
    <div id="editUsernameModal" class="modal-overlay fixed inset-0 flex items-center justify-center hidden">
        <div class="bg-neutral-900 p-6 rounded-xl w-11/12 max-w-sm border border-neutral-700 shadow-2xl">
            <h3 class="text-xl font-bold text-white mb-4">Edit Username</h3>
            <input type="text" id="usernameInput" class="w-full bg-neutral-800 text-white border border-neutral-700 rounded-lg p-3 mb-4 focus:ring-red-500 focus:border-red-500" placeholder="Enter new username">
            <div class="flex justify-end space-x-3">
                <button id="cancelUsernameEdit" class="bg-neutral-700 text-white font-semibold px-4 py-2 rounded-lg hover:bg-neutral-600 transition duration-150">
                    Cancel
                </button>
                <button id="saveUsernameEdit" class="bg-green-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-green-500 transition duration-150">
                    Save
                </button>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        // ------------------ Ø¯Ø§Ù„Ø© ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ù†Ù‚Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ ------------------
        function playBipSound() {
            const bip = document.getElementById('bipSound');
            if (bip) {
                bip.currentTime = 0;
                bip.play().catch(error => {
                    console.log("Audio playback blocked:", error);
                });
            }
        }
        
        // ------------------ Ø¯Ø§Ù„Ø© ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ø±Ø¬ÙˆØ¹ ------------------
        function playBackSound() {
            const back = document.getElementById('backSound');
            if (back) {
                back.currentTime = 0;
                back.play().catch(error => {
                    console.log("Back Audio playback blocked:", error);
                });
            }
        }

        // ------------------ Ù…Ù†Ø·Ù‚ ØªÙˆÙ„ÙŠØ¯ ÙˆØ­ÙØ¸ ID Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ------------------
        function generateUniqueID() {
            let id = '';
            for (let i = 0; i < 10; i++) {
                id += Math.floor(Math.random() * 10);
            }
            return id;
        }

        const idDisplayElement = document.getElementById('uniqueIDDisplay');
        let uniqueID = localStorage.getItem('userAppID');

        if (!uniqueID) {
            uniqueID = generateUniqueID();
            localStorage.setItem('userAppID', uniqueID);
        }

        idDisplayElement.textContent = `ID: ${uniqueID}`;
        // ------------------ Ù†Ù‡Ø§ÙŠØ© Ù…Ù†Ø·Ù‚ ID Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ------------------

        // ------------------ General Setup ------------------
        const displayUsernameElement = document.getElementById('displayUsername');
        const profileNameElement = document.getElementById('profileName'); 
        const backButton = document.getElementById('backButton');
        const logoutButton = document.getElementById('logoutButton');
        const reportFundsButton = document.getElementById('reportFundsButton');
        const editUsernameButton = document.getElementById('editUsernameButton'); 

        // Modal Elements
        const logoutModal = document.getElementById('logoutModal');
        const fundsModal = document.getElementById('fundsModal');
        const confirmLogoutYes = document.getElementById('confirmLogoutYes');
        const confirmLogoutNo = document.getElementById('confirmLogoutNo');
        const closeFundsModal = document.getElementById('closeFundsModal');
        const editUsernameModal = document.getElementById('editUsernameModal');
        const usernameInput = document.getElementById('usernameInput');
        const saveUsernameEdit = document.getElementById('saveUsernameEdit');
        const cancelUsernameEdit = document.getElementById('cancelUsernameEdit');


        // Load Username 
        const username = localStorage.getItem('registeredUsername');
        if (username) {
            displayUsernameElement.textContent = username;
            profileNameElement.textContent = username; 
        } else {
            displayUsernameElement.textContent = 'Guest User';
            profileNameElement.textContent = 'Guest User';
        }

        // ğŸ”Š Back Button (Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ main.html)
        backButton.addEventListener('click', function() {
            playBackSound(); 
            window.location.href = 'dashboard.html'; 
        });

        // ------------------ Ù…Ù†Ø·Ù‚ Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ ÙÙŠ Ø§Ù„Ù‡Ø§ØªÙ ------------------
        window.history.pushState(null, null, window.location.href);
        window.addEventListener('popstate', function(event) {
            playBackSound(); 
            window.location.href = 'dashboard.html';
        });
        // ------------------ Ù†Ù‡Ø§ÙŠØ© Ù…Ù†Ø·Ù‚ Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ ÙÙŠ Ø§Ù„Ù‡Ø§ØªÙ ------------------

        // ------------------ Profile Picture Logic ------------------
        const profileImage = document.getElementById('profileImage');
        const imageUpload = document.getElementById('imageUpload');
        const changeImageButton = document.getElementById('changeImageButton');

        const savedProfileImage = localStorage.getItem('profileImage');
        if (savedProfileImage) {
            profileImage.src = savedProfileImage;
        }

        // ğŸ”Š Change Image Button
        changeImageButton.addEventListener('click', function() {
            playBipSound();
            imageUpload.click();
        });

        imageUpload.addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    profileImage.src = e.target.result;
                    localStorage.setItem('profileImage', e.target.result); 
                };
                reader.readAsDataURL(file);
            }
        });

        // ------------------ Username Modal Logic ------------------

        // ğŸ”Š Open Modal
        editUsernameButton.addEventListener('click', function() {
            playBipSound();
            const currentUsername = displayUsernameElement.textContent;
            usernameInput.value = currentUsername;
            editUsernameModal.classList.remove('hidden');
        });

        // ğŸ”Š Save changes
        saveUsernameEdit.addEventListener('click', function() {
            playBipSound();
            const newUsername = usernameInput.value.trim();
            
            if (newUsername !== '') {
                localStorage.setItem('registeredUsername', newUsername); 
                displayUsernameElement.textContent = newUsername;
                profileNameElement.textContent = newUsername; 
                editUsernameModal.classList.add('hidden');
            } else {
                alert('Username cannot be empty.'); 
            }
        });

        // ğŸ”Š Cancel changes
        cancelUsernameEdit.addEventListener('click', function() {
            playBipSound();
            editUsernameModal.classList.add('hidden');
        });
        
        // ------------------ Log Out Modal Handlers ------------------

        // ğŸ”Š Log Out Button
        logoutButton.addEventListener('click', function() {
            playBipSound();
            logoutModal.classList.remove('hidden');
        });
        
        // ğŸ”Š Confirm Yes (Logout)
        confirmLogoutYes.addEventListener('click', function() {
            playBipSound();
            localStorage.removeItem('registeredUsername');
            localStorage.removeItem('profileImage'); 
            localStorage.removeItem('userAppID'); 
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 50); 
        });

        // ğŸ”Š Confirm No (Logout)
        confirmLogoutNo.addEventListener('click', function() {
            playBipSound();
            logoutModal.classList.add('hidden');
        });

        // ------------------ Funds Modal Handlers ------------------

        // ğŸ”Š Report Funds Problems Button
        reportFundsButton.addEventListener('click', function() {
            playBipSound();
            fundsModal.classList.remove('hidden');
        });

        // ğŸ”Š Close Funds Modal
        closeFundsModal.addEventListener('click', function() {
            playBipSound();
            fundsModal.classList.add('hidden');
        });

    </script>
</body>
</html>
